---  
import TrackList from './TrackList.astro'; 

export interface Props {  
    id: number;  
    title: string;  
    cover: string;  
    releaseDate: string;  
    tracks: string[];  

    /** 各ストリーミングサービスへのURL */
    links?: {
        youtube?: string;
        subscription?: string;
    };
}  

const { title, cover, releaseDate, tracks, links} = Astro.props;
// カバー画像のパスにベースパスを適用
const coverPath = `${import.meta.env.BASE_URL}${cover}`;
// タイトルの改行を<br>タグに変換
const formattedTitle = title.replace(/\n/g, '<br />');
---  
<article class="release-card fade-in-left">  
    <img  
        class="release-cover"  
        src={coverPath}  
        alt={`「${title}」リリースのアルバムカバーアート`}  
        loading="lazy"
    />  
    <div class="release-info">  
        <h3 class="release-title" set:html={formattedTitle}></h3>  
        <time  
            class="release-date"  
            datetime={releaseDate}  
        >  
            {new Date(releaseDate).toLocaleDateString('ja-JP', {  
                year: 'numeric',  
                month: 'long',  
                day: 'numeric'  
            })}  
        </time>  
        <TrackList tracks={tracks} />  
        
        {links && links.subscription && (
            <p class="subscription-note">各種サブスクリプションサービスで配信中</p>
        )}
        
        {links && (
            <div class="subscription-links">
                {links.youtube && (
                <a href={links.youtube} target="_blank" rel="noopener" class="sub-link button" aria-label={`${title}をYouTubeで聴く（新しいタブが開きます）`}>
                    YouTubeで聴く
                </a>
                )}
                {links.subscription && (
                <a href={links.subscription} target="_blank" rel="noopener" class="sub-link button" aria-label={`${title}をサブスクリプションサービスで聴く（新しいタブが開きます）`}>
                    サブスクリプションで聴く
                </a>
                )}
            </div>
        )}
    </div>  
</article>
