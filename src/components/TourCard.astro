---
import '../styles/components.css';
import { getImagePath } from '../utils/paths.js';

export interface Props {
    tour: {
        title: string;
        date: string;
        venue: string;
        city?: string;
        ticketPrice?: string;
        reserve?: string;
        flyer: string;
    }
}
const { tour } = Astro.props;
// 改行を<br />タグに変換
const formattedTicketPrice = tour.ticketPrice?.replace(/\n/g, '<br />');
// フライヤー画像のパスを共通関数で処理
const flyerPath = tour.flyer.startsWith('http') ? tour.flyer : getImagePath(tour.flyer);
---
<article class="tour-card">
    <div class="tour-info">
        <h3>{tour.title}</h3>
        <p>日程: {tour.date}</p>
        <p>会場: {tour.venue}</p>
        {tour.city && <p>場所: {tour.city}</p>}
        {tour.ticketPrice && <p>チケット代: <span set:html={formattedTicketPrice} /></p>}
        {tour.reserve && (
            <p class="tour-reserve">
                予約はこちらから:
                <a href={tour.reserve} target="_blank" rel="noopener noreferrer" class="button">Link</a>
            </p>
        )}
    </div>
    <div class="tour-flyer">
        <img src={flyerPath} alt={`Flyer for ${tour.title}`} loading="lazy" />
    </div>
</article>