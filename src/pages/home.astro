---
import Layout from '../layouts/Layout.astro';
import ReleaseCard from '../components/ReleaseCard.astro';
import ComponentsStyles from '../styles/ComponentsStyles.astro';

import releases from '../data/releases.json';
import tourData from '../data/tour.json';
import TourCard from '../components/TourCard.astro';

// TourItem の型定義（JSON に合わせて更新）
interface TourItem {
    id: number;
    date: string;
    venue: string;
    city: string;           // JSON にある city
    title: string;
    flyer: string;
    ticketPrice?: string;   // 必須でないなら ?
    reserve?: string;
}

// unknown を挟んで型アサーション
const tour = tourData as unknown as TourItem[];
const latestRelease = releases[0];  // 最新リリース（配列の先頭）
---
<Layout>
    <ComponentsStyles />
    <!-- ヒーローセクション -->
    <section class="hero section">    
        <h1>
            goodなmusicを奏でたいyo!!
        </h1>
        <img
            class="header-img"
            src="images/top.JPG"
            alt="ヘッダー画像"
        />
    </section>

    <!-- 最新リリース -->
    <section class="latest-release section">
        <h2>Latest Release</h2>
        {latestRelease && (
            <div class="release-content">
                <ReleaseCard
                    id={latestRelease.id}
                    title={latestRelease.title}
                    cover={latestRelease.cover}
                    releaseDate={latestRelease.releaseDate}
                    tracks={latestRelease.tracks}
                    links={latestRelease.links}
                />
            </div>
        )}
    </section>

    <!-- 次回ライブ -->
    <section class="next-live section">
        <h2>Next Live</h2>
        {tour.length > 0 ? (
            <div class="tour-list">
                <TourCard tour={tour[0]} />
            </div>
        ) : (
            <p class="tour-empty">現在予定されているライブはありません。</p>
        )}
    </section>
</Layout>

<style>
/* Hero セクション */
.hero {
    margin-top: 0;
    margin-bottom: var(--spacing-xl);
}

.hero h1 {
    font-size: clamp(2rem, 5vw, 3rem);
    margin-top: var(--spacing-md);
    margin-bottom: var(--spacing-md);
    text-align: center;
}

.hero .header-img {
    width: 100%;
    max-width: 1000px;
    height: auto;
    display: block;
    margin: var(--spacing-md) auto var(--spacing-xl);
    border-radius: var(--radius-base);
    box-shadow: var(--shadow-base);
}

.section h2 {
    font-size: clamp(1.5rem, 3vw, 2rem);
    margin-top: var(--spacing-md);
    margin-bottom: var(--spacing-md);
    text-align: center;
}

/* レスポンシブ対応 */
@media (max-width: 768px) {
    .hero {
        margin-bottom: var(--spacing-md);
        padding: 0 var(--spacing-md);
    }

    .hero h1 {
        margin: var(--spacing-sm) 0;
    }

    .hero .header-img {
        max-width: 100%;
        margin: var(--spacing-md) auto var(--spacing-lg);
    }
}
</style>
