---
import Layout from '../layouts/Layout.astro';
import ReleaseCard from '../components/ReleaseCard.astro';
import '../styles/home.css';
import '../styles/components.css';
import { getImagePath } from '../utils/paths.js';

import releases from '../data/releases.json';
import tourData from '../data/tour.json';
import TourCard from '../components/TourCard.astro';

// TourItem の型定義（JSON に合わせて更新）
interface TourItem {
    id: number;
    date: string;
    venue: string;
    city: string;           // JSON にある city
    title: string;
    flyer: string;
    ticketPrice?: string;   // 必須でないなら ?
    reserve?: string;
}

// unknown を挟んで型アサーション
const tour = tourData as unknown as TourItem[];
const latestRelease = releases[0];  // 最新リリース（配列の先頭）
---
<Layout>
    <!-- ヒーローセクション -->
    <section class="hero section">    
        <h1>
            goodなmusicを奏でたいyo!!
        </h1>
        <img
            class="header-img"
            src={getImagePath('top.JPG')}
            alt="ヘッダー画像"
        />
    </section>

    <!-- 最新リリース -->
    <section class="latest-release section">
        <h2>Latest Release</h2>
        {latestRelease && (
            <div class="release-content">
                <ReleaseCard
                    id={latestRelease.id}
                    title={latestRelease.title}
                    cover={latestRelease.cover}
                    releaseDate={latestRelease.releaseDate}
                    tracks={latestRelease.tracks}
                    links={latestRelease.links}
                />
            </div>
        )}
    </section>

    <!-- 次回ライブ -->
    <section class="next-live section">
        <h2>Next Live</h2>
        {tour.length > 0 ? (
            <div class="tour-list">
                <TourCard tour={tour[0]} />
            </div>
        ) : (
            <p class="tour-empty">現在予定されているライブはありません。</p>
        )}
    </section>
</Layout>
